<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self';">
    <title>Azure Scripts UI - Administra√ß√£o M365</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="48" height="48" rx="8" fill="#0078D4"/>
                    <path d="M12 16 L24 12 L36 16 L24 36 Z" fill="#50E6FF"/>
                    <path d="M24 12 L36 16 L36 28 L24 36 Z" fill="#0078D4" opacity="0.8"/>
                </svg>
                <div class="header-title">
                    <h1>Azure Scripts UI</h1>
                    <span class="subtitle">Administra√ß√£o Microsoft 365</span>
                </div>
            </div>
            <div class="header-right">
                <div id="ps-status" class="status-badge" title="Status do PowerShell">
                    <span class="status-checking">‚è≥ Verificando...</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Sidebar: Lista de Scripts -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2>üìú Scripts Dispon√≠veis</h2>
                </div>
                <div id="scripts-list" class="scripts-container">
                    <p class="loading-state">Carregando scripts...</p>
                </div>
            </aside>

            <!-- Content Area -->
            <section class="content-area">
                <!-- Script Controls -->
                <div class="script-controls">
                    <div class="selected-info">
                        <span class="label">Selecionado:</span>
                        <span id="selected-script" class="script-name">Nenhum script selecionado</span>
                    </div>
                    <div class="control-buttons">
                        <button id="view-btn" class="btn btn-secondary" disabled title="Visualizar c√≥digo">
                            üëÅÔ∏è Visualizar
                        </button>
                        <button id="run-btn" class="btn btn-primary" disabled title="Executar script">
                            ‚ñ∂Ô∏è Executar
                        </button>
                        <button id="clear-btn" class="btn btn-ghost" title="Limpar output">
                            üóëÔ∏è Limpar
                        </button>
                    </div>
                </div>

                <!-- Output Console -->
                <div class="output-panel">
                    <div class="output-header">
                        <h3>üìü Console de Sa√≠da</h3>
                    </div>
                    <pre id="output" class="output-content"><span class="output-info">Selecione um script e clique em "Executar"...</span></pre>
                </div>

                <!-- Features Grid (collapsible) -->
                <details class="features-section" open>
                    <summary><h3>üöÄ Recursos Planejados</h3></summary>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">üìä</div>
                            <h4>Auditoria Exchange</h4>
                            <p>Executar e visualizar auditorias completas do Exchange Online</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üõ°Ô∏è</div>
                            <h4>Purview & Compliance</h4>
                            <p>Gerenciar pol√≠ticas DLP e configura√ß√µes de compliance</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">‚òÅÔ∏è</div>
                            <h4>OneDrive & SharePoint</h4>
                            <p>Auditoria de seguran√ßa e configura√ß√µes de compartilhamento</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üîê</div>
                            <h4>Conditional Access</h4>
                            <p>An√°lise de pol√≠ticas e troubleshooting</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üíª</div>
                            <h4>Gest√£o de Dispositivos</h4>
                            <p>Remover dispositivos inativos do Entra ID</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">üîÑ</div>
                            <h4>Hybrid Identity</h4>
                            <p>Rota√ß√£o de chaves Kerberos para SSO</p>
                        </div>
                    </div>
                </details>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <span>Azure Scripts UI v1.0.0 | M365 Security Toolkit</span>
            <span class="version-info">
                Electron v<span id="electron-version">-</span> | 
                Node.js v<span id="node-version">-</span>
            </span>
        </footer>
    </div>
    
    <script src="renderer.js"></script>
</body>
</html>
